<!DOCTYPE html>
<html lang="en">

<head>
  {% include 'includes/manager/head.html' %}
</head>

<body class="g-sidenav-show  bg-gray-100">
  
  <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-radius-lg fixed-start ms-2  bg-white my-2" id="sidenav-main">
    {% include 'includes/manager/aside.html' %}
  </aside>

  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-3 shadow-none border-radius-xl" id="navbarBlur" data-scroll="true">
      {% include 'includes/manager/nav.html' %}
    </nav>
    <!-- End Navbar -->

    <div class="container-fluid py-2">

      <div class="row">
        <div class="ms-3">
          <h3 class="mb-0 h4 font-weight-bolder">Dashboard</h3>
          <p class="mb-4">
            Welcome Admin! Here is the global overview of all companies on Fluxa.
          </p>
        </div>

        <!-- All Company -->
        <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-header p-2 ps-3">
              <div class="d-flex justify-content-between">
                <div>
                  <p class="text-sm mb-0 text-capitalize">All Company</p>
                  <h4 id="total-companies" class="mb-0"> {{ total_companies }}</h4>
                </div>
                <div class="icon icon-md icon-shape bg-gradient-dark shadow-dark shadow text-center border-radius-lg">
                  <i translate="no" class="material-symbols-rounded opacity-10">business</i>
                </div>
              </div>
            </div>
            <hr class="dark horizontal my-0">
            <div class="card-footer p-2 ps-3">
              <p class="mb-0 text-sm">For Now</p>
            </div>
          </div>
        </div>

        <!-- Active Subscriptions -->
        <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-header p-2 ps-3">
              <div class="d-flex justify-content-between">
                <div>
                  <p class="text-sm mb-0 text-capitalize">Active Subscriptions</p>
                  <h4 id="active-subscriptions" class="mb-0"> {{ active_subscriptions }}</h4>
                </div>
                <div class="icon icon-md icon-shape bg-gradient-dark shadow-dark shadow text-center border-radius-lg">
                  <i translate="no" class="material-symbols-rounded opacity-10">subscriptions</i>
                </div>
              </div>
            </div>
            <hr class="dark horizontal my-0">
            <div class="card-footer p-2 ps-3">
              <p class="mb-0 text-sm">For this month</p>
            </div>
          </div>
        </div>

        <!-- Inactive Subscriptions -->
        <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
          <div class="card">
            <div class="card-header p-2 ps-3">
              <div class="d-flex justify-content-between">
                <div>
                  <p class="text-sm mb-0 text-capitalize">Inactive Subscriptions</p>
                  <h4 id="inactive-subscriptions" class="mb-0"> {{ inactive_subscriptions }}</h4>
                </div>
                <div class="icon icon-md icon-shape bg-gradient-dark shadow-dark shadow text-center border-radius-lg">
                  <i translate="no" class="material-symbols-rounded opacity-10">pause_circle</i>
                </div>
              </div>
            </div>
            <hr class="dark horizontal my-0">
            <div class="card-footer p-2 ps-3">
              <p class="mb-0 text-sm">For this month</p>
            </div>
          </div>
        </div>

        <!-- Total Budget -->
        <div class="col-xl-3 col-sm-6">
          <div class="card">
            <div class="card-header p-2 ps-3">
              <div class="d-flex justify-content-between">
                <div>
                  <p class="text-sm mb-0 text-capitalize">Total Budget</p>
                  <h4 id="total-budget" class="mb-0"> {{ total_budget}} $</h4>
                </div>
                <div class="icon icon-md icon-shape bg-gradient-dark shadow-dark shadow text-center border-radius-lg">
                  <i translate="no" class="material-symbols-rounded opacity-10">account_balance_wallet</i>
                </div>
              </div>
            </div>
            <hr class="dark horizontal my-0">
            <div class="card-footer p-2 ps-3">
              <p class="mb-0 text-sm">For this month</p>
            </div>
          </div>
        </div> 

      </div>

      <div class="row">

        <!-- Companies by Sector  -->
        <div class="col-lg-4 col-md-6 mt-4 mb-4">
          <div class="card">
            <div class="card-body">
              <h6 class="mb-0">Companies by Sector</h6>
              <p class="text-sm">See which sector uses Fluxa the most</p>
              <div class="pe-2">
                <div class="chart">
                  <canvas id="chart-company" class="chart-canvas" height="170"></canvas>
                </div>
              </div>
              <hr class="dark horizontal">
              <div class="d-flex">
                <i translate="no" class="material-symbols-rounded text-sm my-auto me-1">corporate_fare</i>
                <p class="mb-0 text-sm" id="company-last-update">
                  updated just now
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Active vs Inactive Subscriptions    -->
        <div class="col-lg-4 col-md-6 mt-4 mb-4">
          <div class="card">
            <div class="card-body">
              <h6 class="mb-0">Active vs Inactive Subscriptions</h6>
              <p class="text-sm">Compare subscription renewal activities</p>
              <div class="pe-2">
                <div class="chart">
                  <canvas id="chart-active" class="chart-canvas" height="170"></canvas>
                </div>
              </div>
              <hr class="dark horizontal">
              <div class="d-flex">
                <i translate="no" class="material-symbols-rounded text-sm my-auto me-1">subscriptions</i>
                <p class="mb-0 text-sm" id="active-last-update">
                  updated just now
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Upcoming Renewals  -->
        <div class="col-lg-4 mt-4 mb-3">
          <div class="card">
            <div class="card-body">
              <h6 class="mb-0">Upcoming Renewals</h6>
              <p class="text-sm">Easy to program the notification</p>
              <div class="pe-2">
                <div class="chart">
                  <canvas id="chart-renewals" class="chart-canvas" height="170"></canvas>
                </div>
              </div>
              <hr class="dark horizontal">
              <div class="d-flex">
                <i translate="no" class="material-symbols-rounded text-sm my-auto me-1">notifications</i>
                <p class="mb-0 text-sm" id="renewals-last-update">
                  just updated
                </p>
              </div>
            </div>
          </div>
        </div>

      </div>

      <div class="row mb-4">

        <div class="col-lg-8 col-md-6 mb-md-0 mb-4">
          <div class="card">

            <div class="card-header pb-0">
              <div class="row">

                <div class="col-lg-6 col-7">
                  <h6>Financial Activity</h6>
                  <p class="text-sm mb-0">
                    <i translate="no" class="fa fa-chart-line text-success"></i>
                    <span class="font-weight-bold ms-1">Real-time</span> cash flow tracking
                  </p>
                </div>

              </div>
            </div>

            <div class="card-body px-0 pb-2">
              <div class="table-responsive">

                <table class="table align-items-center mb-0">
                  <thead>
                    <tr>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Type</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Source</th>
                      <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Amount</th>
                      <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for row in finance_rows %}
                    <tr>
                      <td>
                        {% if row.type == "Income" %}
                          <span class="badge bg-gradient-success">Income</span>
                        {% else %}
                          <span class="badge bg-gradient-danger">Expense</span>
                        {% endif %}
                      </td>
                      <td>
                        <h6 class="mb-0 text-sm">{{ row.source }}</h6>
                      </td>
                      <td class="align-middle text-center text-sm">
                        {% if row.type == "Income" %}
                          <span class="font-weight-bold text-success">+{{ row.amount }} {{ row.currency }}</span>
                        {% else %}
                          <span class="font-weight-bold text-danger">-{{ row.amount }} {{ row.currency }}</span>
                        {% endif %}
                      </td>
                      <td class="align-middle text-center">
                        <span class="text-xs font-weight-bold">{{ row.status }}</span>
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>

              </div>
            </div>

          </div>
        </div>

        <div class="col-lg-4 col-md-6">
          <div class="card h-100">
            <div class="card-header pb-0">
              <h6>Sale Prediction by Sale Point</h6>
              <p class="text-sm">
                <i translate="no" class="fa fa-arrow-up text-success" aria-hidden="true"></i>
                <span class="font-weight-bold">This week</span> at a glance
              </p>
            </div>

            <div class="card-body p-3">
              <div class="timeline timeline-one-side">
                {% for p in predictions %}
                <div class="timeline-block mb-3">
                  <span class="timeline-step">
                    <i translate="no" class="material-symbols-rounded text-info text-gradient">bar_chart</i>
                  </span>
                  <div class="timeline-content">
                    <h6 class="text-dark text-sm font-weight-bold mb-0">
                      {{ p.sale_point }} — {{ p.product }}
                    </h6>
                    <p class="text-secondary font-weight-bold text-xs mt-1 mb-0">
                      Prévision: {{ p.predicted_quantity }} unités ({{ p.range }})<br>
                      Revenu estimé: {{ p.predicted_revenue }} {{ company_link.company.currency }}<br>
                      Confiance: {{ p.confidence }}<br>
                      Période: {{ p.period }}
                    </p>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>

      </div>

      <footer class="footer py-4  ">
        {% include 'includes/manager/footer.html' %}
      </footer>

    </div>
  </main>
  
  <!--   Core JS Files   -->
  {% include 'includes/manager/script.html' %}
  
</body>

</html>