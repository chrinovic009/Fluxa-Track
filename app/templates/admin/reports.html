<!DOCTYPE html>
<html lang="en">

<head>
  {% include 'includes/admin/head-admin.html' %}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body class="g-sidenav-show  bg-gray-100">

  <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-radius-lg fixed-start ms-2  bg-white my-2" id="sidenav-main">
    {% include 'includes/admin/aside-admin.html' %}
  </aside>

  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">

    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-3 shadow-none border-radius-xl" id="navbarBlur" data-scroll="true">
      {% include 'includes/admin/nav-admin.html' %}
    </nav>
    <!-- End Navbar -->

    <div class="container-fluid py-2">

      <!-- REPORT TYPES -->
      <div class="row">
        <div class="col-lg-12 col-md-10 mx-auto">
          <div class="card mt-4">
            <div class="card-header p-3">
              <h5 class="mb-0">Report Types</h5>
              <p class="text-sm mb-0">
                Choose a report type to generate detailed insights across all your sales points.
              </p>
            </div>
            <div class="card-body p-3">
              <div class="row">
                <div class="col-lg-3 col-sm-6 col-12">
                  <button class="btn bg-gradient-success w-100 report-btn" data-report="revenue">
                    Revenue & Income
                  </button>
                </div>
                <div class="col-lg-3 col-sm-6 col-12 mt-2 mt-sm-0">
                  <button class="btn bg-gradient-success w-100 report-btn" data-report="expenses">
                    Expenses
                  </button>
                </div>
                <div class="col-lg-3 col-sm-6 col-12 mt-2 mt-lg-0">
                  <button class="btn bg-gradient-success w-100 report-btn" data-report="cashflow">
                    Cash Flow
                  </button>
                </div>
                <div class="col-lg-3 col-sm-6 col-12 mt-2 mt-lg-0">
                  <button class="btn bg-gradient-success w-100 report-btn" data-report="inventory">
                    Inventory
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <br><br>

      <!-- REPORT TABLE -->
      <div class="row">
        <div class="col-12">
          <div class="card my-4">
            <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
              <div class="bg-gradient-dark shadow-dark border-radius-lg pt-4 pb-3">
                <h6 id="report-title" class="text-white ps-3">
                  Revenue & Income (All Sales Points)
                </h6>
              </div>
            </div>

            <div class="card-body px-0 pb-2">
              <div class="table-responsive p-0">
                <table class="table align-items-center mb-0">
                  <thead>
                    <tr id="table-head"></tr>
                  </thead>
                  <tbody id="table-body"></tbody>
                  <tfoot>
                    <tr class="bg-light">
                      <td colspan="3" class="text-end font-weight-bold">TOTAL</td>
                      <td id="table-total" class="font-weight-bold"></td>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        {% if logs %}
          <div class="col-12">
            <div class="card my-4">

              <!-- HEADER -->
              <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
                <div class="bg-gradient-dark shadow-dark border-radius-lg pt-4 pb-3">
                  <h6 class="text-white text-capitalize ps-3">
                    Enterprise Activity History
                  </h6>
                </div>
              </div>

              <!-- BODY -->
              <div class="card-body px-0 pb-2">
                <div class="table-responsive p-0">

                  <table class="table align-items-center justify-content-center mb-0">
                    <thead>
                      <tr>
                        <th>Date & Time</th>
                        <th>Actor</th>
                        <th>Action</th>
                        <th>Module</th>
                        <th>Sales Point</th>
                        <th class="text-center">Impact</th>
                        <th class="text-center">Status</th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for log in logs %}
                      <tr>
                        <!-- Date -->
                        <td>
                          <p class="text-sm mb-0">{{ log.created_at.strftime("%Y-%m-%d %H:%M") }}</p>
                        </td>

                        <!-- Actor -->
                        <td>
                          <div class="d-flex px-2">
                            <div>
                              <h6 class="mb-0 text-sm">{{ log.actor.name if log.actor else "Unknown" }}</h6>
                              <p class="text-xs text-secondary mb-0">{{ log.actor.role if log.actor else "" }}</p>
                            </div>
                          </div>
                        </td>

                        <!-- Action -->
                        <td>
                          <span class="text-sm font-weight-bold">{{ log.action_type }}</span>
                        </td>

                        <!-- Module -->
                        <td>
                          <span class="text-xs font-weight-bold">{{ log.entity }}</span>
                        </td>

                        <!-- Sales Point -->
                        <td>
                          <span class="text-xs font-weight-bold">{{ log.sale_point }}</span>
                        </td>

                        <!-- Impact -->
                        <td class="align-middle text-center">
                          {% if log.impact_value %}
                            {% if log.impact_value > 0 %}
                              <span class="{% if log.action_type == 'sale' or log.action_type == 'New Expense' or log.action_type == 'Delete Product' %}text-danger{% elif log.action_type == 'New Revenue' or log.action_type == 'Adding Product' %}text-success{% endif%} text-sm font-weight-bold">
                                {% if log.action_type == "sale" or log.action_type == "New Expense" or log.action_type == 'Delete Product' %}-{% elif log.action_type == "New Revenue" or log.action_type == 'Adding Product' %}+{% endif%} {{ log.impact_value }} {{ log.impact_unit }}
                              </span>
                            {% elif log.impact_value < 0 %}
                              <span class="text-danger text-sm font-weight-bold">
                                {{ log.impact_value }} {{ log.impact_unit }}
                              </span>
                            {% else %}
                              <span class="text-secondary text-sm font-weight-bold">No Impact</span>
                            {% endif %}
                          {% else %}
                            <span class="text-secondary text-sm font-weight-bold">No Impact</span>
                          {% endif %}
                        </td>

                        <!-- Status -->
                        <td class="align-middle text-center">
                          {% if log.status == "success" %}
                            <span class="badge badge-sm bg-gradient-success">Success</span>
                          {% elif log.status == "failed" %}
                            <span class="badge badge-sm bg-gradient-danger">Failed</span>
                          {% elif log.status == "approved" %}
                            <span class="badge badge-sm bg-gradient-info">Approved</span>
                          {% else %}
                            <span class="badge badge-sm bg-gradient-warning">{{ log.status }}</span>
                          {% endif %}
                        </td>

                        <!-- Options -->
                        <td class="align-middle">
                          <button class="btn btn-link text-secondary mb-0">
                            <i class="fa fa-ellipsis-v text-xs"></i>
                          </button>
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>

                </div>
              </div>

            </div>
          </div>
        {% endif %}
      </div>

      <footer class="footer py-4  ">
        {% include 'includes/admin/footer-admin.html' %}
      </footer>

    </div>
  </main>

  <!--   Core JS Files   -->
  {% include 'includes/admin/script-admin.html' %}

</body>

</html>